{% extends "base.html" %}
{% load static %}

{% block title %}
TKL: AI Chat
{% endblock title %}

{% block extrahead %}
<link rel="stylesheet" href="{% static 'css/chat_style.css' %}">
{% endblock extrahead %}

{% block content %}
<div class="wrapper">
    <div class="new-chat-container"><a id="new-chat" href="{% url 'aichat:chat' %}">New Chat</a></div>
    <div id="chat-box">
        {% for message in messages %}
            {% if message.sender == "system" %}
                <div class="gpt-chat">
                    {{ message }}
                </div>
            {% else %}
                <div class="user-chat">
                    {{ message }}
                    <br>
                    feedback : {{ message.feedback.feedback }}
                    <br>
                    accuracy : {{ message.feedback.accuracy }}
                </div>
            {% endif %}
        {% endfor %}
    </div>
    <form id="chat-form" action="{% url 'aichat:send' id %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input id="text-input" type="text" name="message" placeholder="메시지를 입력하세요">
        
        <!-- 오디오 파일을 선택할 수 있는 파일 입력 상자 추가 -->
        {% comment %} <input type="file" id="audio-input" accept="audio/*" name="audio_file" capture="microphone" style="display:none;"> {% endcomment %}
        {% comment %} <input type="hidden" id="audio-input" accept="audio/*" name="audio_file"> {% endcomment %}


        <!-- 녹음 시작, 중지 버튼 추가 -->
        <br>
        <button id="record" type="button"></button>

        {% comment %} <input id="text-submit" type="submit" value="전송"> {% endcomment %}
    </form>
</div>

<script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script src= "{% static 'js/voiceRecord.js' %}"></script>

{% endblock content %}
